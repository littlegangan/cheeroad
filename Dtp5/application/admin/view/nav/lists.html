{extend name="../application/admin/view/layout.html"}

{block name="content"}

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>导航列表</legend>
</fieldset>

<div class="layui-row layui-form">

	<div class="layui-col-md11"> 
		<div class="layui-inline">
	    	<!-- <input class="layui-input" name="id" id="demoReload" autocomplete="off"> -->
	  	</div>
	  	<!-- <button class="layui-btn" data-type="reload">搜索</button> -->
		<div class="layui-inline">
			<!-- <select name="city" lay-verify="" class="">
			  	<option value="">请选择一个城市</option>
			  	<option value="010">北京</option>
			  	<option value="021">上海</option>
			  	<option value="0571">杭州</option>
			</select> -->
	    </div>
	</div>
	<div class="layui-col-md1">
	    <div class="layui-inline" style="float: right">
			<a class="layui-btn layui-btn-ls" href="{:url('add')}" lay-event="edit">添加</a>
	    </div>
	</div>     

</div>

<table class="layui-table layui-form">
	
	<thead>
		<tr>
			<th width="20"><input type="checkbox" name="" title="" lay-skin="primary" lay-filter="selectAll"></th>
			<th width="250">名称</th>
			<th>图标</th>
			<th>导航地址</th>
			<th>显示状态</th>
			<th>验证状态</th>
			<th>排序</th>
			<th>所在位置</th>
			<th>操作</th>
		</tr> 
	</thead>
	<tbody>
	<!-- 第一级数据 -->
	{volist name="navList" id="value"}
		<tr level="{$value['_level']}">
			<td><input type="checkbox" name="" title="" lay-skin="primary">
			</td>
			<td>{$value['title']}
				<button class="layui-btn layui-btn-xs">

					{empty name="value['_data']"}
					+
					{else /}
					-
					{/empty}

				</button>
			</td>
			<td>{$value['icon']}</td>
			<td>{$value['url']}</td>
			<!-- 显示状态 -->
			<td><input lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF" type="checkbox" {$value['is_show']==1?'checked':''}>
			</td>
			<!-- 启用状态 -->
			<td><input lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF" type="checkbox" {$value['status']==1?'checked':''}></td>
			<td>{$value['sort']}</td>
			<td>{$value['position']}</td>
			<td>
				<a href="{:url('edit', ['id' => $value['id']])}" class="layui-btn layui-btn-normal layui-btn-ls" lay-event="edit"><i class="layui-icon layui-icon-edit"></i>编辑</a>
				<a id="{$value['id']}" class="layui-btn layui-btn-danger layui-btn-ls" lay-event="del"><i class="layui-icon layui-icon-delete"></i>删除</a>
			</td>
		</tr>
		<!-- 第二级数据 -->
		{volist name="value['_data']" id="value_1"}
			<tr level="{$value_1['_level']}">
				<td><input type="checkbox" name="" title="" lay-skin="primary"></td>
				<td>{$value_1['_html']}{$value_1['title']}
					<button class="layui-btn layui-btn-xs">-</button>
				</td>
				<td>{$value_1['icon']}</td>
				<td>{$value_1['url']}</td>
				<!-- 显示状态 -->
				<td><input lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF" type="checkbox" {$value_1['is_show']==1?'checked':''}>
				</td>
				<!-- 启用状态 -->
				<td><input lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF" type="checkbox" {$value_1['status']==1?'checked':''}></td>
				<td>{$value_1['sort']}</td>
				<td>{$value_1['position']}</td>
				<td>
					<a href="{:url('edit', ['id' => $value_1['id']])}" class="layui-btn layui-btn-normal layui-btn-ls" lay-event="edit"><i class="layui-icon layui-icon-edit"></i>编辑</a>
					<a id="{$value_1['id']}" class="layui-btn layui-btn-danger layui-btn-ls" lay-event="del"><i class="layui-icon layui-icon-delete"></i>删除</a>
				</td>
			</tr>
			<!-- 第三级数据 -->
			{volist name="value_1['_data']" id="value_2"}
				<tr level="{$value_2['_level']}">
					<td><input type="checkbox" name="" title="" lay-skin="primary"></td>
					<td>{$value_2['_html']}{$value_2['title']}
						<button class="layui-btn layui-btn-xs">-</button>
					</td>
					<td>{$value_2['icon']}</td>
					<td>{$value_2['url']}</td>
					<!-- 显示状态 -->
					<td><input lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF" type="checkbox" {$value_2['is_show']==1?'checked':''}>
					</td>
					<!-- 启用状态 -->
					<td><input lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF" type="checkbox" {$value_2['status']==1?'checked':''}></td>
					<td>{$value_2['sort']}</td>
					<td>{$value_2['position']}</td>
					<td>
						<a href="{:url('edit', ['id' => $value_2['id']])}" class="layui-btn layui-btn-normal layui-btn-ls" lay-event="edit"><i class="layui-icon layui-icon-edit"></i>编辑</a>
						<a id="{$value_2['id']}" class="layui-btn layui-btn-danger layui-btn-ls" lay-event="del"><i class="layui-icon layui-icon-delete"></i>删除</a>
					</td>
				</tr>
				<!-- 第四级数据 -->
				{volist name="value_2['_data']" id="value_3"}
					<tr>
						<td><input type="checkbox" name="" title="" lay-skin="primary"></td>
						<td>{$value_3['_html']}{$value_3['title']}</td>
						<td>{$value_3['icon']}</td>
						<td>{$value_3['url']}</td>
						<!-- 显示状态 -->
						<td><input lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF" type="checkbox" {$value_3['is_show']==1?'checked':''}>
						</td>
						<!-- 启用状态 -->
						<td><input lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF" type="checkbox" {$value_3['status']==1?'checked':''}></td>
						<td>{$value_3['sort']}</td>
						<td>{$value_3['position']}</td>
						<td>
							<a href="{:url('edit', ['id' => $value_3['id']])}" class="layui-btn layui-btn-normal layui-btn-ls" lay-event="edit"><i class="layui-icon layui-icon-edit"></i>编辑</a>
							<a id="{$value_3['id']}" class="layui-btn layui-btn-danger layui-btn-ls" lay-event="del"><i class="layui-icon layui-icon-delete"></i>删除</a>
						</td>
					</tr>		
				{/volist}		
			{/volist}		
		{/volist}		
	{/volist}	
	</tbody>

</table>

{/block}

{block name="js"}

<script type="text/javascript">

	$(function(){

		//导航列表收缩展开
		$('.layui-btn-xs').click(function(){

			var text = $(this).text();
			var level = $(this).parent().parent().attr('level');
			
			var lastIndex = $('tr[level='+level+']:last').index();

			var curIndex = $(this).parent().parent().index();

			if(lastIndex == curIndex){
				level--;
			}

			//alert(text);
			if(text == '+'){
				$(this).text('-');
				$(this).parent().parent().nextUntil('tr[level = "'+level+'"]').show();
			}else{
				$(this).text('+');
				$(this).parent().parent().nextUntil('tr[level = "'+level+'"]').hide();
			}

		});

		//删除操作弹出层询问框
		$('.layui-btn-danger').click(function(){

			var id = $(this).attr('id');
			layer.confirm('您确定要删除吗？', {icon: 3, title:'提示'}, function(index){
			  	//do something
			  	window.location = 'del/id/' + id;
			  
			  	//关闭弹出层
			  	layer.close(index);
			});

		})

		//复选框全选
		form.on('checkbox(selectAll)', function(data){

			$('tbody :checkbox').prop('checked', data.elem.checked);

			//重新渲染所有复选框
			form.render('checkbox');

		})

	})




</script>


{/block}